<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Stock de Neumáticos</title>
  <style>
    body { font-family: Arial, sans-serif; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #000; padding: 4px; font-size: 13px; }
    th { background: #eee; position: sticky; top: 0; }
    .bajo { background-color: #f8caca; }
    .controles { margin-bottom: 10px; display: flex; flex-wrap: wrap; gap: 10px; }
    input, select { padding: 6px; }
  </style>
</head>
<body>

<h2>Stock de Neumáticos</h2>

<div class="controles">
  <input
    type="text"
    id="buscador"
    placeholder="Buscar artículo, medida, proveedor"
  >

  <select id="proveedor">
    <option value="">Todos los proveedores</option>
  </select>

  <select id="orden">
    <option value="">Ordenar</option>
    <option value="stockAsc">Stock menor → mayor</option>
    <option value="stockDesc">Stock mayor → menor</option>
  </select>
</div>

<table id="tabla"></table>

<script>
const data = [
  ["Proveedor","Articulo","Diametro","Seccion","Tipo","Llanta","Diseno","Telas","Stock","Transito"],

  ["BKT","40130","17.5","","","25","BKT","16","20","0"],
  ["DENGOM S.A.","380","175","65","R","14","FIRES RE740","0","1","0"],
  ["DIAMONDBACK","55186","295","80","MR","22.5","DBA87","18","398","0"],
  ["DIAMONDBACK","55182","295","80","KR","22.5","DRD09","18","182","0"],
  ["DIAMONDBACK","55184","295","80","MR","22.5","TR686","18","215","0"],
  ["DIAMONDBACK","55180","295","80","LR","22.5","TRD06","16","86","0"],
  ["DOUBLESTAR","62114","165","70","TR","13","DH03","4","587","0"],
  ["DOUBLESTAR","62045","165","70","TR","13","DH05","0","560","0"],
  ["DOUBLESTAR","62046","175","65","DH03","14","DH03","0","69","0"],
  ["DOUBLESTAR","62001","175","70","HR","14","DH03","0","82","0"],
  ["DOUBLESTAR","62002","185","60","HR","14","DH08","0","318","0"],
  ["DOUBLESTAR","62003","185","65","HR","14","DH03","","1","0"],
  ["DOUBLESTAR","62004","185","70","HR","14","DH03","0","13","0"],
  ["DOUBLESTAR","62018","185","60","HR","15","DH03","0","288","0"],
  ["DOUBLESTAR","62019","185","65","HR","15","DH05","0","868","0"],
  ["DOUBLESTAR","62005","195","55","VR","15","DH03","0","984","0"],
  ["DOUBLESTAR","62006","195","60","VR","15","DH03","0","840","0"]
];

const headers = data[0];
let rows = data.slice(1);

const tabla = document.getElementById("tabla");
const buscador = document.getElementById("buscador");
const proveedorSel = document.getElementById("proveedor");
const ordenSel = document.getElementById("orden");

// cargar proveedores
[...new Set(rows.map(r => r[0]))].forEach(p => {
  const opt = document.createElement("option");
  opt.value = p;
  opt.textContent = p;
  proveedorSel.appendChild(opt);
});

function render(filas) {
  tabla.innerHTML =
    "<tr>" +
    headers.map(h => `<th>${h}</th>`).join("") +
    "</tr>" +
    filas.map(r => {
      const stock = Number(r[8]) || 0;
      return (
        `<tr class="${stock < 20 ? "bajo" : ""}">` +
        r.map(c => `<td>${c}</td>`).join("") +
        "</tr>`
      );
    }).join("");
}

function aplicarFiltros() {
  let filtradas = [...rows];

  const q = buscador.value.toLowerCase();
  if (q) {
    filtradas = filtradas.filter(r =>
      r.join(" ").toLowerCase().includes(q)
    );
  }

  if (proveedorSel.value) {
    filtradas = filtradas.filter(r => r[0] === proveedorSel.value);
  }

  if (ordenSel.value === "stockAsc") {
    filtradas.sort((a,b) => (Number(a[8])||0) - (Number(b[8])||0));
  }

  if (ordenSel.value === "stockDesc") {
    filtradas.sort((a,b) => (Number(b[8])||0) - (Number(a[8])||0));
  }

  render(filtradas);
}

buscador.addEventListener("input", aplicarFiltros);
proveedorSel.addEventListener("change", aplicarFiltros);
ordenSel.addEventListener("change", aplicarFiltros);

render(rows);
</script>

</body>
</html>